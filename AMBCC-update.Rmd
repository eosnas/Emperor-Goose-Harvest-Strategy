---
title: "2021 update to emperor goose theta-logistic model"
author: "Erik Osnas, USFWS MBM, Alaska"
date: "`r Sys.Date()`"
output: powerpoint_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(AKaerial)
library(dplyr)
library(ggplot2)
load("../EMGO_predict/.RData")
out2 <- readRDS("summer_theta_logistic_2021.RDS")
ykd <- filter(YKGHistoric$combined, Species == "EMGO") %>% 
  select(Year, itotal, itotal.se)
options(scipen = 5)
```

## Outline

- Theta-logistic state-space model
  - Results of update after three hunting seasons (to 2019)
  - Consequence for management strategy revision
- State-space model used for 2020 and 2021 predictions
  - Discuss how to make predictions when data is missing

## The Theta-logistic model
- In the 2016 the USFWS (Dooley et al , Osnas and Frost) used this model to understand sustainable harvest and predict optimal harvest management decision rules (closure thresholds).  
\newline
- Actual management decision rules were determined based on negotiation between the all stakeholders (USFWS, ADFG, and Native Caucus) 

## The Theta-logistic model
- commonly used for harvest management  
  * fisheries, polar bear, whales, waterfowl
  * used to estimate population parameters
    * growth rate ($\boldsymbol{r}_{max}$)
    * carrying capacity (population size without harvest, $\boldsymbol{K}$)
    * $\boldsymbol\Theta$, 'non-linear density-dependence'
    * these determine equilibrium population size for a given harvest level (MSY)

## The Theta-logistic model: parameters
$$N_{t+1} = N_t + N_t \boldsymbol{r} \left[1 - \left(\frac{N_t}{\boldsymbol{K}}\right)^\boldsymbol{\theta} \right] - \frac{H_t}{(1 - c)}$$
\newline
$$N_{t+1} \sim LogNormal(log(N_{t+1}), \boldsymbol\sigma)$$
\newline
$$Y_t \sim Normal(\boldsymbol{q} N_t, \sigma_{obs,t})$$

## The Theta-logistic model: data
$$N_{t+1} = N_t + N_t r \left[1 - \left(\frac{N_t}{K}\right)^\theta \right] - \frac{\boldsymbol{H}_t}{(1 - c)}$$
\newline
$$N_{t+1} \sim LogNormal(log(N_{t+1}), \sigma)$$
\newline
$$\boldsymbol{Y}_t \sim Normal(q N_t, \boldsymbol{\sigma}_{obs,t})$$
\newline  

*in 2016 there was no harvest under a C&T season

## 2016 priors

!['kill' rate is actually plotted, H/(1-c)](harvest_plot-1.png)

## 2016 Objectives: harvest
![](H_utility-1.png) ![](P_utility-1.png)

## 2016 Objectives: population size
![](P_utility-1.png)

## 2016 Results
![](plot_on_data-1.png)

## Actual harvest thresholds
![](emgo-update-2019.PNG)  

## Update: 2019 results
![](theta-logistic-2021.png)

## Compare results: K
![](compare-K-posteriors.png)

## Compare results: growth rate
![](compare-r_max-posteriors.png)

## Compare results: harvest
![](compare-harvest-prior-posterior.png)

## Consequences of model updates
- the updated posterior for a customary and tradition season harvest will favor 
  - **lower closure thresholds**, all else equal
  - less frequent season closure or changes
  
\newline

- harvest posterior is only based on three data points
  - it will change with more data
  - only long-term averages can be estimated well
  - still no data for "Yellow" or "conservation measures" season

## Consider for revision:

1.  re-derive and negotiate new decision thresholds under new harvest data
2.  seek more input on population and harvest objectives from *all stakeholders*
3.  evaluate and revise population model (theta-logistic)
4.  other data sources?
5.  other?

## 2021 Predictions from simple state-space model
![](../EMGO_predict/ssm1.NewData.png)  

## Simple state-space model
$$log(N_{t+1}) = log(N_t) + \boldsymbol{r}_t $$
\newline
$$\boldsymbol{r}_{t} \sim Normal(\boldsymbol{\hat r}, \boldsymbol\sigma)$$
\newline
$$Y_t \sim Normal( N_t, \sigma_{obs,t})$$

## Theta-logistic v. Simple model for prediction
![](compare-thelta-logistic-simple.png)

## How to make predictions under missing data
- last observed data point (2019 'management index'): 
  - $26583 \pm 1230$ (1 SE)
- lagging three-year average (2016 - 2019): 
  - `r round(mean(ykd$itotal[33:35]),1)`
- posterior mean of last state-space model population: 
  - `r round(last(out2$mean$N.est),1)`
- posterior of predicted 'management index': 
  - `r round(out$mean$y.new, 1)` $\pm$ `r round(out$sd$y.new, 1)` (1 SE)
